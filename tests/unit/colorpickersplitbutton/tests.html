<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Color Picker Split Button Tests</title>
	<link type="text/css" rel="stylesheet"href="../../../src/css/themes/infragistics/infragistics.theme.css" />

    <link type="text/css" rel="stylesheet" href="../../../src/css/structure/modules/infragistics.ui.shared.css" media="screen" />
    <link type="text/css" rel="stylesheet" href="../../../src/css/structure/modules/infragistics.ui.toolbarbutton.css" media="screen" />
    <link type="text/css" rel="stylesheet" href="../../../src/css/structure/modules/infragistics.ui.popover.css" media="screen" />
    <link type="text/css" rel="stylesheet" href="../../../src/css/structure/modules/infragistics.ui.splitbutton.css" media="screen" />
    <link type="text/css" rel="stylesheet" href="../../../src/css/structure/modules/infragistics.ui.colorpicker.css" media="screen" />
	
	<link type="text/css" href="../../../bower_components/qunit/qunit/qunit.css" rel="stylesheet" media="screen" />
     
	<script type="text/javascript" src="../../../bower_components/jquery/dist/jquery.js"></script>
	<script type="text/javascript" src="../../../bower_components/jquery-tmpl/jquery.tmpl.js"></script>
	<script type="text/javascript" src="../../../bower_components/jquery-ui/jquery-ui.js"></script>
	<script type="text/javascript" src="../../../bower_components/qunit/qunit/qunit.js"></script>

    <script type="text/javascript" src="../../../src/js/modules/infragistics.util.js"></script>
	<script type="text/javascript" src="../../../src/js/modules/infragistics.ui.shared.js"></script>
    <script type="text/javascript" src="../../../src/js/modules/infragistics.ui.popover.js"></script>
    <script type="text/javascript" src="../../../src/js/modules/infragistics.ui.colorpicker.js"></script>
    <script type="text/javascript" src="../../../src/js/modules/infragistics.ui.toolbarbutton.js"></script>
    <script type="text/javascript" src="../../../src/js/modules/infragistics.ui.splitbutton.js"></script>
	<script type="text/javascript" src="../../../src/js/modules/infragistics.ui.colorpickersplitbutton.js"></script>

	<script type="text/javascript">
	    var equalWithEpsilon = function (a, b, epsilon) {
	        return Math.abs(a - b) < epsilon;
	    }

	    var unitTestsSetup = {
	        colorPickerSplitButtonSelector: "color-picker-split-button",
	        actualColorPickerSplitButton: null,
	        setup: function () {
	            $('body').append($("<div></div>").attr("id", this.colorPickerSplitButtonSelector));
	            $(this.id(this.colorPickerSplitButtonSelector)).igColorPickerSplitButton({
	                items: [{
	                    name: "textColor",
	                    label: "Font Color",
	                    icon: "ui-igbutton-forecolor"
	                }],
	                defaultItemName: "textColor",
	                hasDefaultIcon: false,
	                selectedTextColor: "red",
	                expanded: function (evt, ui) {
	                	$('<input>').attr('type','hidden').val('expanded').appendTo(evt.target);
	                },
	                 click: function (evt, ui) {
	                	$('<input>').attr('type','hidden').val('clicked').appendTo(evt.target);
	                },
	                collapsed: function (evt, ui) {
	                	$('<input>').attr('type','hidden').val('collapsed').appendTo(evt.target);
	                }
	            });
	            this.actualColorPickerSplitButton = $(this.id(this.colorPickerSplitButtonSelector)).data("ui-igColorPickerSplitButton");
	        },
	        teardown: function () {
	            this.actualColorPickerSplitButton.destroy()
	            $(this.id(this.colorPickerSplitButtonSelector)).remove();
	        },
	        id: function (selector) {
	            return "#" + selector;
	        }
	    };

	    module("igColorPickerSplitButton unit tests", unitTestsSetup);


	   

	    test("_onColorSelect", function () {
	        var ui = { color: "#f1f1f1" };
	        this.actualColorPickerSplitButton._onColorSelect({}, ui);
	        
	        deepEqual(this.actualColorPickerSplitButton.options.defaultColor, ui.color, "changed default color");
	    });

	    test("expand", function () {
	        this.actualColorPickerSplitButton.expand(true);
	        this.actualColorPickerSplitButton._triggerExpanded();
	        var isExpanded = this.actualColorPickerSplitButton.element.find("input").val();
	        
	        equal(isExpanded, "expanded", "Expand color picker");
	    });

	    test("setColor", function () {
	    	var getDefaultValue = this.actualColorPickerSplitButton.options.defaultColor;
	    	
	    	equal(getDefaultValue, "#000", "Set default color to picker");

	    	var  color = "#f0f0f0";
	        this.actualColorPickerSplitButton.setColor(color)
	        var getDefaultChangedColor = this.actualColorPickerSplitButton.options.defaultColor;
	        
	        equal(getDefaultChangedColor, color, "Select color to picker");
	    });

	    test("_setOption", function () {
	    	var color = "#afafaf";
	    	this.actualColorPickerSplitButton._setOption("defaultColor", color);
	    	var getDefaultColor = this.actualColorPickerSplitButton.options.defaultColor;

	    	this.actualColorPickerSplitButton._setButtonColorIndicator("#ffffff");

	    	equal(getDefaultColor, color, "Set default color through setOption method");
	    })

	    test("_setButtonColorIndicator", function () {
	    	var color = "#ffffff";
	    	this.actualColorPickerSplitButton._setButtonColorIndicator(color);

	    	var getRgbColor = hexToRgb(color);

	    	var getBtnColorIndicatorColor = this.actualColorPickerSplitButton.element.children(":first").children(":first").css("background-color");

	    	this.actualColorPickerSplitButton._onItemClick();

	    	equal(getBtnColorIndicatorColor, getRgbColor, "Set button color indicator when doesn't have default icon");
	    })

	    test("_onItemClick", function () {
	    	notEqual(this.actualColorPickerSplitButton._onItemClick(), "When invoke _onItemClick than return statement is false");
	    })

	    test("_onDefaultButtonClick", function () {
	    	// Check before click if input element exist
	    	var clickInputValue = this.actualColorPickerSplitButton.element.find("input").val();
	    	var getDefaultButton = this.actualColorPickerSplitButton.element.children(":first").children(":first");
	    	
	    	equal(clickInputValue, undefined, "Check if default button is clicked");
	    	
	    	getDefaultButton.trigger("click");
	    	// Check after click the input element value
	    	clickInputValue = this.actualColorPickerSplitButton.element.find("input").val();

	    	equal(clickInputValue, "clicked", "Check if default button is clicked");
	    })

	    test("_preventCollapsing", function () {
	    	var isPreventCollapsing = this.actualColorPickerSplitButton._preventCollapsing();
	    	equal(isPreventCollapsing, false, "Is prevent collapsing return false");
	    })

	    test("_setOptinWithEqualKeyValues", function () {
	    	var color = "#afafaf";

	    	notEqual(color, this.actualColorPickerSplitButton.options.defaultColor, "Given color value isn't equal with defaultColor value");

	    	this.actualColorPickerSplitButton._setOption("defaultColor", color);
	    	equal(color, this.actualColorPickerSplitButton.options.defaultColor, "given color value is equal with standardColor value");
	    	
	    	this.actualColorPickerSplitButton._setOption("defaultColor", color);
	    	equal(color, this.actualColorPickerSplitButton.options.defaultColor, "given color value is equal with standardColor value");
	    
	    })
	    
	    test("collpasePickerWithArguments", function () {
			this.actualColorPickerSplitButton.collapse(true);
			var isCollapsed = this.actualColorPickerSplitButton.element.find("input").val();
			ok(isCollapsed, "If collapsed event was triggered");
	    })	


	    function hexToRgb(hex) {
	    	var valueWithoutSymbol = hex.slice(1, hex.length);
	    	var bigint = parseInt(valueWithoutSymbol, 16);
		    var r = (bigint >> 16) & 255;
		    var g = (bigint >> 8) & 255;
		    var b = bigint & 255;

	    	return hexToRgb = "rgb(" + r + ", " + g + ", " + b + ")";
	    }
	</script>
</head>
<body>
	<!--<div id="qunit"></div>
    <div id="qunit-fixture"></div>-->
	
	
	<div style="float:right;width:400px;overflow:auto;">
		<h1 id="qunit-header">Test results</h1>
		<h2 id="qunit-banner"></h2>
		<h2 id="qunit-userAgent"></h2>
		<ol id="qunit-tests"></ol>
	</div>
	
</body>
</html>